> 途中からになってしまったが。。。

実装の切り出し

> DisplayText プロパティの処理内容を別のクラスに委譲したいです。
> CalcLibCore.Tomida2.implements.DisplayTextImpl というクラスを作成し、そちらにToDispay>というメソッドを作って処理を委譲してください。DisplayTextプロパティはgetのみで、setは不要なのでset処理は削除してください。

名前空間の指示をミスったので直してもらう

> すみません。CalcLibCore.Tomida2.implements.DisplayTextImpl クラスを CalcLibCore.Tomida2.Calc.implements.DisplayTextImpl へリファクタリングしてください。

バックスペース対応、Undoの機能をMementパターンで作ってもらう

> CalcContextTomida2 内のデータを保存する仕組みをMementパターンを使って実装してください。実現する機能はUndoだけで良いです。保存する情報はRawInputとIsResultDisplayedの2つで良いです。作成するクラスは、CalcLibCore.Tomida2.Calc.Mement名前空間に作成して、同じフォルダ構成でファイルを保存してください。

作成された。履歴が10個までしか保存しない仕様になっていたので、int.MaxValue にする。これはこちらでやった。

続いてこれをBackspaceBtnのストラテジに紐づける。

> 既存の CalcButton を処理する実装を参考にし、BtnBS が渡された場合のStrategyとFactoryを追加してください。BtnBSでの処理は、先程作成したMementのUndoを1回行ってください。

出力されたBSボタンのテストがNUnitで書かれていたので、標準テストフレームワーク用に書き直させた。

> 生成されたBackspaceButtonTestについて、NUnitではなく標準のテストフレームワークでの記載に変更してください。

引き算のテストケースが失敗していたので原因を究明し修正させた。

> CalcLibCoreTest.CalcSvcTest.TestMinus が失敗しました。原因を突き止めて修正してください。

SubDisplayの実装を行う。

> DisplayText と同様の手法で、SubDisplayText をオーバーライドしてください。SubDisplayTextImplクラスを作成してください。ToDisplayの仕様は、
- オペランドとオペレーターの間に半角空白を入れて、そのまま式を出力する
です。例えばrawInputが "1+23*45" であれば、出力は"1 + 23 * 45" となります。

一旦作ってもらったが仕様と異なっていたので追加で指示をだした。

> SubDisplayImpl の仕様を変更してください。
- 式の末尾がオペランドの場合、そのオペランドは表示しないようにする
- 式の末尾が `=` の場合、出力は空文字列とする
つまり、 入力と出力のペアが以下のようになってほしいです。
 "1" => ""
 "1+" => "1 +"
 "1+2 => "1 +"
 "1+2=" => "" 

 指示しきれていなかった仕様の修正を順に行ってもらう

 > オペレーターが連続したら上書きされること

 > メインディスプレイの整数部はカンマ区切りにすること

 rowInput のtypoを修正していなかったので、リファクタリングをさせた。

 > リファクタリングをお願いします。
現在、 `rowInput` または `RowInput` になっているプロパティや編集は、 `rawInput` もしくは `RawInput` に名称変更してください。 row と raw を取り違えていました。

完了。
サブディスプレイ表示で末尾がイコールかどうかを判定する処理で、 rawInputを参照している。rawInputはあくまで入力されたデータの塊で、システムとして処理の判断はparseした結果を使って欲しい。そのようになるよう修正リクエストした。

> SubDisplayTextImpl#ToDisplay中の
```
            // 末尾が=の場合は空文字を返す
            if (rawInput.TrimEnd().EndsWith("="))
            {
                return string.Empty;
            }
```
について、入力の末尾がイコールかどうかを判定するのをrawInputからではなく parseResult から判断するように修正してください

小数点が絡む計算で誤差が出るようなテスト結果が出た。おそらくどこかでDobuleで計算していると思われるので当該箇所を探して修正するよう指示。

> サブディスプレイのテスト の140行明で Assert.AreEqual failed. Expected:<-3,329.8>. Actual:<-3,329.8000000000002>.  とのメッセージでテストが失敗しています。
計算のロジックで浮動小数点を使っているのでしょうか。テストが通るよう、Decimalのような誤差のない型で計算するよう修正してください。

指示したのだが他のテストで落ちている箇所も一緒に修正しようとした。1プロンプトで解決できないようなので、こちらでコードを読んでアプローチを指示する必要が出てきた。

